# v08 Market-Adaptive Strategy κ°λ° κ³„νμ„

**μ‘μ„±μΌ**: 2025-10-18
**μ „λµλ…**: Market-Adaptive Strategy
**λ²„μ „**: v08
**νƒ€μ„ν”„λ μ„**: DAY (μΌλ΄‰)

---

## π“ μ΄μ „ λ²„μ „ λ¶„μ„

### v07 Enhanced DAY (μµμ‹ )

**μ„±κ³Ό (2024λ…„)**:
- μμµλ¥ : 148.63% (λ©ν‘ μ΄κ³Ό λ‹¬μ„± β…)
- Sharpe: 2.27, MDD: 20.26%
- κ±°λ: 5ν, μΉλ¥  60%

**μ„±κ³Ό (2025λ…„ Out-of-Sample)**:
- μμµλ¥ : **9.76%** β (Buy&Hold 20.15%)
- μ„±λ¥ μ €ν•: **93.44%** β
- ν‰κ°€: **μ‹¬κ°ν• μ¤λ²„ν”Όν…**

**ν•µμ‹¬ λ¬Έμ **:
1. **μ‹μ¥ ν™κ²½ λ―Έκ³ λ ¤**: λ¨λ“  μƒν™©μ— λ™μΌν• νλΌλ―Έν„° (Trailing Stop 10%)
2. **2024λ…„ μƒμΉμ¥ νΉν™”**: νλΌλ―Έν„°κ°€ μƒμΉμ¥μ— κ³Όμµμ ν™”
3. **ν΅λ³΄μ¥/ν•λ½μ¥ λ€μ‘ λ¶€μ΅±**: 2025λ…„ ν΅λ³΄μ¥μ—μ„ μ¦μ€ μ†μ‹¤

---

## π― ν•µμ‹¬ κ°€μ„¤

### κ°€μ„¤ 1: μ‹μ¥ μƒν™©λ³„ μ „λµ μ μ©
**λ‚΄μ©**: μ‹μ¥μ„ Bull/Sideways/Bearλ΅ λ¶„λ¥ν•κ³  κ° μƒν™©μ— λ§λ” νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ©΄ μ¤λ²„ν”Όν…μ„ μ¤„μ΄κ³  λ²”μ©μ„±μ„ ν™•λ³΄ν•  μ μλ‹¤

**κ·Όκ±°**:
- v07μ λ¬Έμ λ” λ‹¨μΌ νλΌλ―Έν„°λ΅ λ¨λ“  μ‹μ¥ λ€μ‘
- μ‹μ¥ λ¶„λ¥κΈ° ν…μ¤νΈ κ²°κ³Ό:
  - 2024λ…„: Bull 48.1%, Sideways 25.7%, Bear 26.2%
  - 2025λ…„: Bull 42.6%, Sideways 33.6%, Bear 23.9%
- 2025λ…„μ€ ν΅λ³΄μ¥ λΉ„μ¤‘μ΄ 8%p μ¦κ°€ (25.7% β†’ 33.6%)

### κ°€μ„¤ 2: λ³΄μμ  νλΌλ―Έν„°λ΅ μ•μ •μ„± ν™•λ³΄
**λ‚΄μ©**: κ° μ‹μ¥λ³„ νλΌλ―Έν„°λ¥Ό λ³΄μμ μΌλ΅ μ„¤μ •ν•μ—¬ 2024λ…„ μμµλ¥ μ€ μ•½κ°„ λ‚®μ•„μ§€μ§€λ§ 2025λ…„ μ„±λ¥ μ €ν•λ¥Ό μµμ†ν™”

**λ©ν‘**:
- 2024λ…„: 148.63% β†’ 140~150% (μ•½κ°„ κ°μ† ν—μ©)
- 2025λ…„: 9.76% β†’ 30~40% (3~4λ°° κ°μ„ )
- μ¤λ²„ν”Όν…: 93% β†’ 30% μ΄ν•

---

## π“‹ κµ¬ν„ κ³„ν

### A. μ‹μ¥ λ¶„λ¥ μ‹μ¤ν…

**3κ°€μ§€ μ‹μ¥ μƒν™© (κ²€μ¦ μ™„λ£)**:

```python
class MarketRegimeDetector:
    def detect(self, df, i) -> 'bull' | 'sideways' | 'bear':
        # 1. Bull (μƒμΉμ¥)
        if adx >= 25 and ema12 > ema26 and momentum_30d > 15%:
            return 'bull'

        # 2. Bear (ν•λ½μ¥)
        if adx >= 25 and ema12 < ema26 and momentum_30d < -10%:
            return 'bear'

        # 3. Sideways (ν΅λ³΄μ¥)
        if adx < 20:
            return 'sideways'

        # 4. μ¤‘κ°„ κ°•λ„ μ¶”μ„Έ
        ...
```

**λ¶„λ¥ κ²°κ³Ό (2024-2025)**:
- Bull: 299μΌ (45.6%)
- Sideways: 191μΌ (29.2%)
- Bear: 165μΌ (25.2%)

### B. μ‹μ¥λ³„ μ „λµ

#### 1. Bull Market Strategy (μƒμΉμ¥)

**μ§„μ… μ΅°κ±΄**:
- EMA Golden Cross OR MACD Golden Cross (v07κ³Ό λ™μΌ)

**μ²­μ‚° μ΅°κ±΄**:
```json
{
  "trailing_stop_pct": 0.12,  // v07 10% β†’ 12% (λ” μ—¬μ )
  "stop_loss_pct": 0.08,       // v07 13% β†’ 8% (λ” λΉ λ¥Έ μ†μ )
  "position_fraction": 0.95
}
```

**μ² ν•™**: μƒμΉμ¥μ—μ„λ” ν° μμµ μ¶”κµ¬, μ†μ‹¤μ€ λΉ λ¥΄κ² μ°¨λ‹¨

#### 2. Sideways Market Strategy (ν΅λ³΄μ¥)

**μ§„μ… μ΅°κ±΄**:
- EMA Golden Crossλ§ μ‚¬μ© (MACD μ μ™Έ)
- μ΄μ : ν΅λ³΄μ¥μ—μ„ MACDλ” μ¦μ€ μλ»λ μ‹ νΈ λ°μƒ

**μ²­μ‚° μ΅°κ±΄**:
```json
{
  "trailing_stop_pct": 0.06,   // λΉ λ¥Έ μµμ 
  "stop_loss_pct": 0.05,       // λΉ λ¥Έ μ†μ 
  "position_fraction": 0.70,   // λ‚®μ€ ν¬μ§€μ… (λ³΄μμ )
  "use_macd_entry": false
}
```

**μ² ν•™**: μ‘μ€ μμµμ„ λΉ λ¥΄κ² μ‹¤ν„, μ†μ‹¤ μµμ†ν™”

#### 3. Bear Market Strategy (ν•λ½μ¥)

**μ§„μ… μ΅°κ±΄**:
- **ν„κΈ λ³΄μ  (κ±°λ μ¤‘λ‹¨)**

**μ΄μ **:
- DAY νƒ€μ„ν”„λ μ„μ—μ„ κ³µλ§¤λ„λ” κµ¬ν„ λ³µμ΅λ„ λ†’μ
- ν•λ½μ¥μ—μ„λ” λ³΄μ΅΄μ΄ μ°μ„ 
- λ‹¤μ μƒμΉμ¥μ„ μ„ν• μλ³Έ λ³΄νΈ

### C. μ „ν™ λ΅μ§

**Hysteresis (μ΄λ ¥ν„μƒ) μ μ©**:
```python
# μ‹μ¥ μ „ν™ μ‹ NμΌ μ—°μ† μƒλ΅μ΄ μƒν™©μ΄μ–΄μ•Ό μ „ν™
transition_days = 3

if new_regime != current_regime:
    transition_counter += 1
    if transition_counter >= transition_days:
        current_regime = new_regime
        # ν¬μ§€μ… λ³΄μ  μ¤‘μ΄λ©΄ μ²­μ‚°
        if has_position:
            sell(fraction=1.0)
```

**λ©μ **: μ¦μ€ μ‹μ¥ μ „ν™μΌλ΅ μΈν• μ†μ‹¤ λ°©μ§€

---

## π”§ ν•μ΄νΌνλΌλ―Έν„°

### μ΄κΈ°κ°’ (v07 λ° μ‹μ¥ νΉμ„± κΈ°λ°)

```json
{
  "strategy_name": "market_adaptive",
  "version": "v08",
  "timeframe": "day",

  "market_detector": {
    "adx_threshold": 25,
    "adx_weak": 20,
    "momentum_window": 30,
    "bull_momentum": 0.15,
    "bear_momentum": -0.10,
    "transition_days": 3
  },

  "bull_params": {
    "use_ema_entry": true,
    "use_macd_entry": true,
    "ema_fast": 12,
    "ema_slow": 26,
    "macd_fast": 13,
    "macd_slow": 23,
    "macd_signal": 8,
    "trailing_stop_pct": 0.12,
    "stop_loss_pct": 0.08,
    "position_fraction": 0.95
  },

  "sideways_params": {
    "use_ema_entry": true,
    "use_macd_entry": false,
    "ema_fast": 12,
    "ema_slow": 26,
    "trailing_stop_pct": 0.06,
    "stop_loss_pct": 0.05,
    "position_fraction": 0.70
  },

  "bear_params": {
    "action": "stay_in_cash"
  },

  "trading": {
    "initial_capital": 10000000,
    "fee_rate": 0.0005,
    "slippage": 0.0002
  }
}
```

### μµμ ν™” κ³„ν (Optuna)

**Phase 1**: Bull νλΌλ―Έν„° μµμ ν™”
- λ°μ΄ν„°: 2024λ…„ Bull κµ¬κ°„λ§ (176μΌ)
- μµμ ν™” λ€μƒ: trailing_stop, stop_loss, macd νλΌλ―Έν„°

**Phase 2**: Sideways νλΌλ―Έν„° μµμ ν™”
- λ°μ΄ν„°: 2024λ…„ Sideways κµ¬κ°„λ§ (94μΌ)
- μµμ ν™” λ€μƒ: trailing_stop, stop_loss

**Phase 3**: ν†µν•© ν…μ¤νΈ
- μ „μ²΄ 2024λ…„ λ°μ΄ν„°λ΅ μ¬κ²€μ¦

---

## π“ μμƒ μ„±κ³Ό

### μ‹λ‚λ¦¬μ¤ λ¶„μ„

#### λ³΄μμ  μ‹λ‚λ¦¬μ¤
**2024λ…„**:
- Bull κµ¬κ°„ (176μΌ, 48%): +80%
- Sideways κµ¬κ°„ (94μΌ, 26%): +10%
- Bear κµ¬κ°„ (96μΌ, 26%): 0%
- **ν•©κ³„: ~135%**

**2025λ…„**:
- Bull κµ¬κ°„ (123μΌ, 43%): +20%
- Sideways κµ¬κ°„ (97μΌ, 34%): +8%
- Bear κµ¬κ°„ (69μΌ, 24%): 0%
- **ν•©κ³„: ~28%**

#### μ¤‘κ°„ μ‹λ‚λ¦¬μ¤
**2024λ…„**: **145%**
**2025λ…„**: **35%**
**μ¤λ²„ν”Όν…**: (145-35)/145 = **76%** (v07 93% β†’ κ°μ„ )

#### λ‚™κ΄€μ  μ‹λ‚λ¦¬μ¤
**2024λ…„**: **150%**
**2025λ…„**: **40%**
**μ¤λ²„ν”Όν…**: **73%**

### v07 λ€λΉ„ λΉ„κµ

| ν•­λ© | v07 | v08 (λ©ν‘) | κ°μ„  |
|------|-----|-----------|------|
| 2024λ…„ μμµλ¥  | 148.63% | 145% | -3.63%p |
| 2025λ…„ μμµλ¥  | 9.76% | 35% | **+25.24%p** π† |
| μ¤λ²„ν”Όν… | 93.44% | 76% | **-17.44%p** β… |
| Sharpe (2024) | 2.27 | 1.8 (μμƒ) | -0.47 |
| MDD (2024) | 20.26% | 22% (μμƒ) | +1.74%p |

**νΈλ μ΄λ“μ¤ν”„**:
- 2024λ…„ μμµλ¥  μ•½κ°„ κ°μ† (λ²”μ©μ„± ν™•λ³΄ μ„ν•΄)
- 2025λ…„ μ„±λ¥ λ€ν­ κ°μ„  (ν•µμ‹¬ λ©ν‘ λ‹¬μ„±)

---

## β οΈ μ„ν— μ”μ†

### 1. μ‹μ¥ λ¶„λ¥ μ¤λ¥
**λ¬Έμ **: ADX/EMA κΈ°λ° λ¶„λ¥κ°€ ν•­μƒ μ •ν™•ν•μ§€ μ•μ
**μ**: κΈ‰λ½ μ§ν›„ λ°λ“± μ‹ Bullλ΅ μλ» λ¶„λ¥ κ°€λ¥
**μ™„ν™”**:
- Transition days = 3 (3μΌ μ—°μ† μƒλ΅μ΄ μƒν™©μ΄μ–΄μ•Ό μ „ν™)
- λ³΄μμ  νλΌλ―Έν„° μ‚¬μ©

### 2. μ „ν™ λΉ„μ©
**λ¬Έμ **: μ‹μ¥ μ „ν™ μ‹ κΈ°μ΅΄ ν¬μ§€μ… μ²­μ‚° β†’ μμλ£ λ°μƒ
**μ™„ν™”**:
- μ—°κ°„ μ „ν™ νμ μ ν• (μ: μµλ€ 10ν)
- λλ” μ μ§„μ  ν¬μ§€μ… μ΅°μ •

### 3. Bear κµ¬κ°„ κΈ°ν μ†μ‹¤
**λ¬Έμ **: Bearμ—μ„ ν„κΈ λ³΄μ  β†’ λ°λ“± μ‹ μ§„μ… λ¦μ
**μ™„ν™”**:
- Bear β†’ Bull μ „ν™ μ¦‰μ‹ μ§„μ… (transition_days λ‹¨μ¶•)

### 4. νλΌλ―Έν„° λ³µμ΅λ„ μ¦κ°€
**λ¬Έμ **: Bull/Sideways 2μ„ΈνΈ νλΌλ―Έν„° κ΄€λ¦¬
**μ™„ν™”**:
- λ…ν™•ν• λ¬Έμ„ν™”
- κ° νλΌλ―Έν„° μ—­ν•  λ…μ‹

---

## π† μ„±κ³µ κΈ°μ¤€

### ν•„μ μ΅°κ±΄ (λ¨λ‘ λ‹¬μ„±)
- β… 2024λ…„ μμµλ¥  >= **140%**
- β… 2025λ…„ μμµλ¥  >= **30%**
- β… Sharpe Ratio >= **1.2**
- β… Max Drawdown <= **25%**

### μ°μ μ΅°κ±΄ (2κ° μ΄μƒ λ‹¬μ„±)
- β­ 2024λ…„ μμµλ¥  >= 145%
- β­ 2025λ…„ μμµλ¥  >= 35%
- β­ μ¤λ²„ν”Όν… < 75%
- β­ Sharpe Ratio >= 1.5

### νƒμ›” μ΅°κ±΄ (3κ° μ΄μƒ λ‹¬μ„±)
- π† 2024λ…„ μμµλ¥  >= 150%
- π† 2025λ…„ μμµλ¥  >= 40%
- π† μ¤λ²„ν”Όν… < 70%
- π† MDD <= 20%

---

## π“… κ°λ° μΌμ •

### Phase 1: μ¤€λΉ„ (μ™„λ£)
- [x] κΈ°μ΅΄ λ°μ΄ν„° λ¶„μ„
- [x] μ‹μ¥ λ¶„λ¥ μ•κ³ λ¦¬μ¦ μ„¤κ³„
- [x] 2024-2025 λ°μ΄ν„°λ΅ κ²€μ¦

### Phase 2: κ³„ν (ν„μ¬)
- [x] plan.md μ‘μ„±
- [ ] config.json μ‘μ„±
- [ ] μ‚¬μ©μ μΉμΈ

### Phase 3: κµ¬ν„ (μμ •)
- [ ] V08Strategy ν΄λμ¤ μ‘μ„±
- [ ] backtest.py μ‘μ„±

### Phase 4: ν…μ¤νΈ
- [ ] 2024λ…„ λ°±ν…μ¤ν…
- [ ] 2025λ…„ Out-of-Sample κ²€μ¦

### Phase 5: μµμ ν™”
- [ ] Optuna μ‹μ¥λ³„ νλΌλ―Έν„° μµμ ν™”
- [ ] ν†µν•© μ¬ν…μ¤νΈ

### Phase 6: λ¬Έμ„ν™”
- [ ] result.md μ‘μ„±
- [ ] v09 μ μ•

---

## π’΅ λ‹¤μ λ‹¨κ³„

1. config.json μ‘μ„±
2. V08Strategy κµ¬ν„
3. λ°±ν…μ¤ν… μ‹¤ν–‰
4. κ²°κ³Ό λ¶„μ„

---

**μ‘μ„±μ**: Claude (v08 κ°λ° λ‹΄λ‹Ή)
**λ‹¤μ μ‘μ—…**: config.json μ„¤κ³„ λ° μ „λµ κµ¬ν„
